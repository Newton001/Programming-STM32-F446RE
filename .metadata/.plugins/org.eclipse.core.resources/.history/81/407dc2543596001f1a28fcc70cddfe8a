/*
 * mma7660fc.c
 *
 *  Created on: Oct 29, 2024
 *      Author: newton
 */

#ifndef MMA7660FC_H
#define MMA7660FC_H

#include "i2c.h"
#include "stm32f4xx_hal.h"

#define ACCEL_ADDRESS 0x90
#define TEST_MODE 0

extern I2C_HandleTypeDef hi2c1;

// Simple Function to detect Devices on the I2C Bus

void I2C_Scan(void)
{
	printf("Scanning I2C bus ....\r\n");

	HAL_StatusTypeDef result;
	uint8_t i;

	// Loop through each address from 0x03 to 0x77 (its a 7-bit I2C adesses)
	for(i = 1; i<256; i++)
	{
		// Probe Each Address
		result = HAL_I2C_IsDeviceReady(&hi2c1, (uint16_t)(i<<1), 1, 10);

		if(result = HAL_OK)
			printf("Device found at address: 0x%02X\r\n", i);
		else
			printf("No response at address: 0x%02X\r\n", i);
	}
	printf("Scan Complete. \r\n");
}

#endif /* MMA7660FC_H_ */
